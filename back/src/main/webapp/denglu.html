<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1,maximum-scale=1, minimum-scale=1">
    <title>登录</title>
    <link href="lib/ionic/css/ionic.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <script src="lib/ionic/js/angular/angular.js"></script>
    <script src="js/myjs.js"></script>
    <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>   
  </head>
  <body ng-app="app" ng-controller="DashCtrl" >
    <div class="ersi" style="height: 4rem; background:#ff7733 ;text-align: center;color: white; line-height: 4rem;">
    	登录
    </div>
    <div id="dl" style="padding: 15px;">
    	<input type="text" id="name" name="name" ng-model="name" placeholder="输入用户名" required/>
    	<input type="password" id="password" name="password" ng-model="password" placeholder="输入密码" required/>
    </div>
	
     <div class="checkbox" >
                <label>
                    <input id="inputchock" type="checkbox"  name="checkbox"  style="float: left;">
                    <p style="float: left;margin: 4px 10px;">记住密码</p>
                </label>
		
      </div>
    <div style="padding: 15px;">
    	<button id="denhlu" class="button button-full dybutton" ng-disabled="myForm.name.$error.required ||myForm.password.$error.required">
                             确定
        </button>
        <div class="shiliu">
        	<span style="float: left;">
        		<a href="czmima.html"  style="color: #444;font-size: 16px;" >重置密码</a>	
        	</span>
        	<span style="float: right;">
        		<a href="zhuce.html"  style="color:#ff7733 ;font-size: 16px;">注册</a>
        	</span>
        </div>
        
    </div>
    
    
  </body>
  <script type="text/javascript">
  window.alert = function(name){
 var iframe = document.createElement("IFRAME");
iframe.style.display="none";
iframe.setAttribute("src", 'data:text/plain,');
document.documentElement.appendChild(iframe);
window.frames[0].window.alert(name);
iframe.parentNode.removeChild(iframe);
}
  var app = angular.module("app",[]);
    app.controller("DashCtrl",function ($scope) {
    	
    })

 function addCookie(name,value,days,path){     
    var name = escape(name);  
    var value = escape(value);  
    var expires = new Date();  
    expires.setTime(expires.getTime() + days * 3600000 * 24);  
    path = path == "" ? "" : ";path=" + path;  
    var _expires = (typeof days) == "string" ? "" : ";expires=" + expires.toUTCString();  
    document.cookie = name + "=" + value + _expires + path;  
}  
function getCookieValue(name){   
    var name = escape(name);  
    var allcookies = document.cookie; 
    name += "=";  
    var pos = allcookies.indexOf(name);      
    if (pos != -1){                                             
        var start = pos + name.length;                
        var end = allcookies.indexOf(";",start);       
        if (end == -1) end = allcookies.length;         
        var value = allcookies.substring(start,end); 
        return (value);                               
    }else{  符串  
        return "";  
    }  
}  
function deleteCookie(name,path){   
    var name = escape(name);  
    var expires = new Date(0);  
    path = path == "" ? "" : ";path=" + path;  
    document.cookie = name + "="+ ";expires=" + expires.toUTCString() + path;  
}  
  window.onload = function(){  
    var userNameValue = getCookieValue("phone");  
    document.getElementById("name").value = userNameValue;  
    var userPassValue = getCookieValue("password");  
    document.getElementById("password").value = userPassValue;  
   if(userNameValue==""){
    console.log("无")
    }else{
    	$('#inputchock').attr("checked","checked")
    }
}  
  
  	
  	 $("#denhlu").click(function(){ 
  	 	var passwords =	$("#password").val();
  	  var phone = $("#name").val();
         if($('#inputchock').is(':checked')){  
	        addCookie("phone",phone,7,"/");  
	        addCookie("password",passwords,7,"/");   
	    }else{  
	        deleteCookie("phone","/");
	        deleteCookie("password","/");  
	    } 
	    var data ={"phone":phone,"password":passwords} ;
       data= JSON.stringify(data);
  	  console.log(phone)
        $.ajax({
            url:"http://localhost/ws/account/login",
            type:"POST",
            contentType:"application/json",
            data:data,
            success:function(res){
            if(res.status==0){
            		var token = res.data;
            		console.log(res);
//          		window.location.href='zfwc.html'
            		window.location.href ='index.html?name='+token;
            	}else{
            	 alert(res.errorMessage);
            	}
            },
            error:function(res){
                console.log(res)
            }
        })
    });
  </script>
</html>
